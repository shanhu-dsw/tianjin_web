(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36853cd8"],{"0481":function(e,t,i){"use strict";var a=i("23e7"),n=i("a2bf6"),l=i("7b0b"),o=i("07fa"),r=i("5926"),s=i("65f0");a({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=l(this),i=o(t),a=s(t,0);return a.length=n(a,t,t,i,0,void 0===e?1:r(e)),a}})},"04d1":function(e,t,i){var a=i("342f"),n=a.match(/firefox\/(\d+)/i);e.exports=!!n&&+n[1]},4069:function(e,t,i){var a=i("44d2");a("flat")},"4e82":function(e,t,i){"use strict";var a=i("23e7"),n=i("e330"),l=i("59ed"),o=i("7b0b"),r=i("07fa"),s=i("083a"),u=i("577e"),d=i("d039"),c=i("addb"),m=i("a640"),p=i("04d1"),f=i("d998"),h=i("2d00"),b=i("512ce"),g=[],v=n(g.sort),_=n(g.push),y=d((function(){g.sort(void 0)})),x=d((function(){g.sort(null)})),k=m("sort"),w=!d((function(){if(h)return h<70;if(!(p&&p>3)){if(f)return!0;if(b)return b<603;var e,t,i,a,n="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(a=0;a<47;a++)g.push({k:t+a,v:i})}for(g.sort((function(e,t){return t.v-e.v})),a=0;a<g.length;a++)t=g[a].k.charAt(0),n.charAt(n.length-1)!==t&&(n+=t);return"DGBEFHACIJK"!==n}})),T=y||!x||!k||!w,C=function(e){return function(t,i){return void 0===i?-1:void 0===t?1:void 0!==e?+e(t,i)||0:u(t)>u(i)?1:-1}};a({target:"Array",proto:!0,forced:T},{sort:function(e){void 0!==e&&l(e);var t=o(this);if(w)return void 0===e?v(t):v(t,e);var i,a,n=[],u=r(t);for(a=0;a<u;a++)a in t&&_(n,t[a]);c(n,C(e)),i=r(n),a=0;while(a<i)t[a]=n[a++];while(a<u)s(t,a++);return t}})},"512ce":function(e,t,i){var a=i("342f"),n=a.match(/AppleWebKit\/(\d+)\./);e.exports=!!n&&+n[1]},a2bf6:function(e,t,i){"use strict";var a=i("e8b5"),n=i("07fa"),l=i("3511"),o=i("0366"),r=function(e,t,i,s,u,d,c,m){var p,f,h=u,b=0,g=!!c&&o(c,m);while(b<s)b in i&&(p=g?g(i[b],b,t):i[b],d>0&&a(p)?(f=n(p),h=r(e,t,p,f,h,d-1)-1):(l(h+1),e[h]=p),h++),b++;return h};e.exports=r},addb:function(e,t,i){var a=i("4dae"),n=Math.floor,l=function(e,t){var i=e.length,s=n(i/2);return i<8?o(e,t):r(e,l(a(e,0,s),t),l(a(e,s),t),t)},o=function(e,t){var i,a,n=e.length,l=1;while(l<n){a=l,i=e[l];while(a&&t(e[a-1],i)>0)e[a]=e[--a];a!==l++&&(e[a]=i)}return e},r=function(e,t,i,a){var n=t.length,l=i.length,o=0,r=0;while(o<n||r<l)e[o+r]=o<n&&r<l?a(t[o],i[r])<=0?t[o++]:i[r++]:o<n?t[o++]:i[r++];return e};e.exports=l},b211:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"update"},[i("div",{staticClass:"top"},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"left"},[e._m(0),i("el-input",{attrs:{disabled:!0},model:{value:e.oldOddsStatus.id,callback:function(t){e.$set(e.oldOddsStatus,"id",t)},expression:"oldOddsStatus.id"}}),i("el-input",{attrs:{disabled:!0},model:{value:e.oldlocation,callback:function(t){e.oldlocation=t},expression:"oldlocation"}}),i("el-input",{attrs:{disabled:!0},model:{value:e.oldName,callback:function(t){e.oldName=t},expression:"oldName"}}),i("el-input",{attrs:{disabled:!0},model:{value:e.oldTime,callback:function(t){e.oldTime=t},expression:"oldTime"}}),i("el-input",{attrs:{disabled:!0},model:{value:e.oldProblem,callback:function(t){e.oldProblem=t},expression:"oldProblem"}})],1),i("div",{staticClass:"right"},[e._m(1),i("el-form",{attrs:{"label-position":e.labelPosition,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"问题编号","label-width":"100px"}},[i("el-input",{model:{value:e.uuid,callback:function(t){e.uuid=t},expression:"uuid"}})],1),i("el-form-item",{attrs:{label:"责任单位","label-width":"100px"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.unitMultipleValue,callback:function(t){e.unitMultipleValue=t},expression:"unitMultipleValue"}},e._l(e.unitMultiple,(function(e){return i("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),i("el-form-item",{attrs:{label:"问题类型","label-width":"100px"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.problemType,callback:function(t){e.problemType=t},expression:"problemType"}},e._l(e.problemTypeList,(function(e){return i("el-option",{key:e.uuid,attrs:{label:e.name,value:e.uuid}})})),1)],1),i("el-form-item",{attrs:{label:"检查时间","label-width":"100px"}},[i("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.newTime,callback:function(t){e.newTime=t},expression:"newTime"}})],1),i("el-form-item",{attrs:{label:"问题描述","label-width":"100px"}},[i("el-input",{model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1),i("el-form-item",{attrs:{label:"创建单位","label-width":"100px"}},[i("el-input",{model:{value:e.admin.department_uuid2_name,callback:function(t){e.$set(e.admin,"department_uuid2_name",t)},expression:"admin.department_uuid2_name"}})],1),i("el-form-item",{attrs:{label:"创建人","label-width":"100px"}},[i("el-input",{model:{value:e.admin.real_name,callback:function(t){e.$set(e.admin,"real_name",t)},expression:"admin.real_name"}})],1),i("el-form-item",{attrs:{label:"问题附件图片","label-width":"100px"}},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getRandomObjects(e.fileImgUrl)}}},[e._v("随机筛选")]),i("el-button",{attrs:{type:"primary"},on:{click:e.order}},[e._v("顺序筛选")])],1)],1)],1)]),i("div",{staticClass:"img"},[i("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange},model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},e._l(e.fileImgUrl[e.imgIndex],(function(e){return i("el-checkbox",{key:e,attrs:{label:e}},[i("el-image",{staticStyle:{width:"15em",height:"10em",display:"block",margin:"0 auto"},attrs:{src:e}})],1)})),1)],1),i("div",{staticClass:"btnPre"},[i("el-button",{attrs:{type:"text"},on:{click:function(t){return e.previous(1)}}},[i("i",{staticClass:"el-icon-back"}),e._v(" 上一页")]),i("el-button",{attrs:{type:"text"},on:{click:function(t){return e.previous()}}},[e._v("下一页 "),i("i",{staticClass:"el-icon-right"})])],1),i("div",{staticClass:"bottom-btn"},[i("el-button",{attrs:{type:"info"},on:{click:e.empty}},[e._v("清空还原")]),i("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确认导入")])],1)])},n=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"oldOdds"},[i("span",[e._v("原始记录")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:" newOdds"},[i("span",[e._v("新系统记录")])])}],l=(i("a9e3"),i("0481"),i("4069"),i("4e82"),i("fb6a"),i("a15b"),i("d3b7"),i("159b"),i("14d9"),i("a4d3"),i("e01a"),i("25f0"),i("b0c0"),i("4de4"),i("d81d"),i("bc3a")),o=i.n(l),r=i("9d9a"),s={name:"",data:function(){return{pingUrl:"",pingUrlSuffix:"",imgIndex:0,checkList:[],fileImgUrl:[],newTime:"",description:"",unitMultipleValue:"",uuid:"",loading:!1,dataForm:{},message_user:[],labelPosition:"right",problemTypeList:[],problemType:"",oldOddsStatus:[],oldlocation:"",oldName:"",oldTime:"",oldProblem:"",unitMultiple:[]}},props:{token:{type:String},id:{type:Number,default:0},admin:{type:Object}},watch:{id:{handler:function(e){e&&(console.log(this.unitMultipleValue),this.unitMultipleValue="",this.problemType="",this.init(e))},deep:!0,immediate:!0}},filters:{},methods:{empty:function(){},getRandomObjects:function(e){var t=e.flat();t.sort((function(){return.5-Math.random()}));var i=t.slice(0,10);return this.checkList=i},order:function(){this.checkList=this.fileImgUrl[0]},submit:function(){var e=this;this.pingUrl=this.checkList.join("|");var t=[];this.checkList.forEach((function(e){t.push(e.substring(e.lastIndexOf(".")+1))})),this.pingUrlSuffix=t.join("|").toUpperCase(),console.log(this.pingUrlSuffix);var i={uuid:this.uuid,type:"DEPARTMENT",from_uuid:this.admin.uuid,to_uuid:this.unitMultipleValue,type_uuid:this.problemType,content:this.description,file_url:this.pingUrl,file_suffix:this.pingUrlSuffix,problem_type:"CHECK",from_lv2_department_uuid:this.admin.department_uuid2,to_lv2_department_uuid:this.unitMultipleValue,create_datetime:this.newTime};this.pingUrl||delete i.pingUrl,this.pingUrlSuffix||delete i.file_suffix,Object(r["f"])(i).then((function(t){e.$message({message:"导入成功",type:"success"}),e.$emit("change",!1),e.getmessage_user(t.uuid)})).catch((function(t){t.toString().indexOf("svp_problem.PRIMARY")>-1?e.$message.error("问题编号已存在！！"):e.$message.error(t)}))},getmessage_user:function(e){var t=this,i={rows:1e3,offset:0,manage_department_uuid_like:this.unitMultipleValue};Object(r["o"])(i).then((function(i){t.message_user=i.array;var a=t.admin.real_name+"("+t.admin.name+")",n=t.problemTypeList.filter((function(e){return e.uuid==t.problemType}))[0].name,l=t.unitMultiple.filter((function(e){return e.uuid==t.unitMultipleValue}))[0].name;console.log(n),console.log(l);var o=l+",于“"+t.newTime+"”被“"+a+"”发现“"+n+"”的问题，请及时整改。",s={from_uuid:t.admin.uuid,to_uuid:"",title:"发现"+n+"的问题",content:o,remark:e};t.message_user.map((function(e){s.to_uuid=e.uuid,Object(r["d"])(s).then((function(){})).catch((function(e){console.log(e)}))}))}))},previous:function(e){if(1==e){if(!(this.imgIndex>0))return this.$message.error("已经是第一页了！");this.imgIndex--}else{if(!(this.imgIndex<this.fileImgUrl.length-1))return this.$message.error("已经是最后一页了！");this.imgIndex++}},handleCheckedCitiesChange:function(e){console.log(e),e.length>10&&(alert("不能大于十张"),this.checkList.pop())},init:function(e){var t=this;this.loading=!0,this.uuid=e,o()({url:"http://17.62.1.11/api/problems/"+e,method:"GET",params:{},headers:{Authorization:"Bearer "+this.token}}).then((function(e){if(200==e.status){t.loading=!1,t.getUnit(),t.oldOddsStatus=e.data.data,t.oldName=e.data.data.problem_category.name,e.data.data.location.path.length>3&&(t.oldlocation=e.data.data.location.path[3].name),t.oldTime=t.parseTime(e.data.data.issued_at),t.newTime=t.oldTime,t.oldProblem=e.data.data.note?e.data.data.note:e.data.data.problem_category.name,t.description=e.data.data.note?e.data.data.note:e.data.data.problem_category.name;var i=e.data.data.problem_evidences,a=[];i.forEach((function(e){a.push(e.img_data.src?e.img_data.src:"")}));var n=10;t.fileImgUrl=t.twoDimensional(a,n)}else t.$message.error("请求失败")})).catch((function(e){console.log(e)}))},getUnit:function(){var e=this;Object(r["q"])({level:2}).then((function(t){var i=t.array;e.unitMultiple=t.array,i.forEach((function(t){if("督察审计支队"==t.name){var i=t.problem_types.filter((function(e){return"检查问题"==e.name}))[0].uuid;e.problemTypeList=t.problem_types.filter((function(e){return e.parent_uuid==i})),e.problemTypeList.forEach((function(t){-1!=t.name.indexOf(e.oldName)&&(console.log(t,"item"),e.problemType=t.uuid)}))}t.name==e.oldlocation&&(e.unitMultipleValue=t.uuid)}))}))},getProblem:function(){var e=this;Object(r["A"])().then((function(t){e.problemTypeList=t.array,e.problemTypeList.forEach((function(t){-1!=t.name.indexOf(e.oldName)&&(e.problemType=t.uuid)}))}))},twoDimensional:function(e,t){for(var i=[],a=e.length,n=a%t==0?a/t:Math.ceil(a/t),l=0;l<n;l++){var o=e.slice(l*t,(l+1)*t);i.push(o)}return i}},computed:{}},u=s,d=(i("e51d"),i("2877")),c=Object(d["a"])(u,a,n,!1,null,"7f968246",null);t["default"]=c.exports},c971:function(e,t,i){},d998:function(e,t,i){var a=i("342f");e.exports=/MSIE|Trident/.test(a)},e51d:function(e,t,i){"use strict";i("c971")}}]);