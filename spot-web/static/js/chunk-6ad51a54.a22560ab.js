(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ad51a54"],{"062b":function(t,e,i){"use strict";i("43b1")},"0c6d":function(t,e,i){},"25aa":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"component-upload-image"},[i("el-upload",{attrs:{action:"#","auto-upload":!1,"file-list":t.uploadList2,"on-change":t.onChangeUpload,"on-remove":t.handlerRemoveImage,"before-remove":t.handlerBeforeRemove,"on-exceed":t.onUpdateExceed,drag:"",multiple:"",limit:t.limit}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[t._v(" 将文件拖到此处，或"),i("em",[t._v("点击上传")])])]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 请上传 "),t.fileSize?[t._v(" 大小不超过 "),i("b",{staticStyle:{color:"#f56c6c"}},[t._v(t._s(t.fileSize)+"MB")])]:t._e(),t.fileType?[t._v(" 格式为 "),i("b",{staticStyle:{color:"#f56c6c"}},[t._v(t._s(t.fileType.join("/")))])]:t._e(),t._v(" 的文件 ")],2)],1)},s=[],r=i("c7eb"),a=i("1da1"),l=(i("a9e3"),i("4de4"),i("d3b7"),i("b0c0"),i("14d9"),i("fb6a"),i("a15b"),i("3e8f"),{props:{uploadList:[String,Object,Array],limit:{type:Number,default:5},fileSize:{type:Number,default:5},fileType:{type:Array,default:function(){return["png","jpg","jpeg","doc","docx","xls","xlsx","pdf","zip"]}}},computed:{},data:function(){return{uploadList2:[]}},methods:{onChangeUpload:function(t,e){console.log(t);var i=this.validateFile(t);if(!i)return this.uploadList2=this.uploadList2.filter((function(e){return e.uid!==t.uid})),!1;var o=this,s=new FileReader;s.readAsDataURL(t.raw),s.onload=function(e){t.content=s.result,t.suffix=t.name.substring(t.name.lastIndexOf(".")+1).toUpperCase(),o.uploadList2.push(t),o.$emit("update:uploadList",o.uploadList2)}},handlerRemoveImage:function(t,e){var i=this;return Object(a["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:i.uploadList2=i.uploadList2.filter((function(e){return e.uid!==t.uid})),i.$emit("update:uploadList",i.uploadList2);case 2:case"end":return e.stop()}}),e)})))()},handlerBeforeRemove:function(t,e){return this.$confirm("确定移除 ".concat(t.name,"？"))},onUpdateExceed:function(){this.$modal.msgError("上传文件数量不能超过 ".concat(this.limit," 个!"))},validateFile:function(t){var e=!1,i="";if(t.name.lastIndexOf(".")>-1&&(i=t.name.slice(t.name.lastIndexOf(".")+1)),e=this.fileType.some((function(t){return!!(i&&i.indexOf(t)>-1)})),!e)return this.$modal.msgError("文件格式不正确, 请上传".concat(this.fileType.join("/"),"格式文件!")),!1;if(this.fileSize){var o=t.size/1024/1024<this.fileSize;if(!o)return this.$modal.msgError("上传文件大小不能超过 ".concat(this.fileSize," MB!")),!1}return!0}}}),n=l,c=(i("6d25"),i("2877")),u=Object(c["a"])(n,o,s,!1,null,"ac32e658",null);e["a"]=u.exports},"3e8f":function(t,e){},"43b1":function(t,e,i){},"6d25":function(t,e,i){"use strict";i("0c6d")},"6e00":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("div",{staticStyle:{display:"flex","background-color":"#fff"}},[i("div",{staticClass:"prClass"},[i("el-row",{staticClass:"prHeader",attrs:{type:"flex"}},[i("div",{staticClass:"number"},[t._v(" 问题编号 "),i("span",[t._v("#"+t._s(t.modelPr.number))])]),i("div",{staticClass:"title"},[i("el-row",{staticClass:"desc"},[t._v(" "+t._s(t.modelPr.department_name+"在"+t.parseTime(t.modelPr.create_datetime,"{y}年{m}月{d}日")+'发生了"'+t.modelPr.problem_department_type_name+'"的问题。')+" ")]),i("el-row",{staticStyle:{"margin-bottom":"10px"}},[t._v(" 来源： "),i("el-tag",{attrs:{type:"info",effect:"dark",size:"small"}},[t._v("人工录入")])],1),i("el-row",[t._v(" 状态： "),"UN_FEEDBACK"==t.modelPr.status?i("el-tag",{attrs:{type:"warning",effect:"dark",size:"small"}},[t._v("未确认")]):t._e(),"FEEDBACK"==t.modelPr.status?i("el-tag",{attrs:{type:"success",effect:"dark",size:"small"}},[t._v("已反馈")]):t._e(),"FILED"==t.modelPr.status?i("el-tag",{attrs:{type:"info",effect:"dark",size:"small"}},[t._v("已归档")]):t._e()],1)],1)]),i("el-row",{staticClass:"prInfo",attrs:{type:"flex"}},[i("span",{staticClass:"title"},[t._v("问题详情")])]),i("el-row",{staticClass:"content"},[i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[t._v("问题类别:")]),t._v(t._s(t.modelPr.problem_department_type_name)+" ")]),i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[t._v("问题类型:")]),t._v(t._s(t.modelPr.problem_department_type_parent_name)+" ")])]),i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[t._v("被检查单位:")]),t._v(t._s(t.modelPr.department_name)+" ")]),i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[t._v("问题责任人:")]),t._v(t._s(t.modelPr.resArry?t.modelPr.resArry.join(","):"")+" ")])]),i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[t._v("创建单位:")]),t._v(t._s(t.modelPr.from_department_name)+" ")]),i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[t._v("创建人:")]),t._v(t._s(t.modelPr.from_real_name+"("+t.modelPr.from_account_name+")")+" ")])]),i("div",{staticClass:"content-row small"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[t._v("问题描述:")])]),i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[t._v("检查时间:")]),t._v(t._s(t.modelPr.create_datetime)+" ")])]),i("div",{staticClass:"content-desc"},[t._v(" "+t._s(t.htmlDecode(t.modelPr.content))+" ")]),t.modelPr.storage_file==[]?i("div",{staticClass:"content-row small"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title"},[t._v("问题附件:")])])]):t._e(),t._l(t.modelPr.storage_file,(function(e,o){return i("div",{key:o,staticClass:"content-row hand"},[i("div",{staticClass:"content-col"},[e.isImg?i("img",{staticClass:"img",attrs:{src:e.url2},on:{click:function(i){return t.viewImg(e.url2)}}}):t._e(),e.isImg?t._e():i("div",{staticClass:"file",on:{click:function(i){return t.downLoad(e.url2)}}},[i("img",{staticClass:"img",attrs:{src:t.fileImg}}),i("span",[t._v(t._s(e.url))]),i("div",{staticClass:"download"},[i("i",{staticClass:"el-icon-download"})])])])])}))],2),i("el-row",{staticClass:"prInfo",attrs:{type:"flex"}},[i("span",{staticClass:"title"},[t._v("问题反馈")])]),t.isFeedBack?i("el-row",{staticClass:"content"},[i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[t._v("该问题于【")]),t._v(t._s(t.modelFb.last_update_datetime)+" "),i("div",{staticClass:"content-title1"},[t._v("】被【")]),t._v(t._s(t.modelFb.from_admin_array[0].real_name)+"（"+t._s(t.modelFb.from_admin_array[0].name)+"）"),i("div",{staticClass:"content-title1"},[t._v("】反馈为")]),"NOT_FACT"==t.modelPr.is_fact?i("el-tag",{attrs:{type:"warning",effect:"dark"}},[t._v("不属实")]):t._e(),"FACT"==t.modelPr.is_fact?i("el-tag",{attrs:{type:"success",effect:"dark"}},[t._v("属实")]):t._e()],1)]),i("div",{staticClass:"content-row small"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[t._v("反馈情况如下:")])])]),i("div",{staticClass:"content-desc1"},[t._v(" "+t._s(t.htmlDecode(t.modelFb.content))+" ")]),t.modelFb.storage_file.length>0?i("div",{staticClass:"content-row small"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[t._v("问题附件:")])])]):t._e(),t._l(t.modelFb.storage_file,(function(e,o){return i("div",{key:o,staticClass:"content-row hand"},[i("div",{staticClass:"content-col"},[e.isImg?i("img",{staticClass:"img",attrs:{src:e.url2},on:{click:function(i){return t.viewImg(e.url2)}}}):t._e(),e.isImg?t._e():i("div",{staticClass:"file",on:{click:function(i){return t.downLoad(e.url2)}}},[i("img",{staticClass:"img",attrs:{src:t.fileImg}}),i("span",[t._v(t._s(e.url))]),i("div",{staticClass:"download"},[i("i",{staticClass:"el-icon-download"})])])])])}))],2):t._e(),t.isFeedBack||t.fbDisabled?t._e():i("el-row",{staticClass:"content"},[i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[t._v("问题暂无反馈信息，点击”")]),i("el-link",{attrs:{type:"primary"},on:{click:t.openFbEidt}},[t._v("反馈问题")]),i("div",{staticClass:"content-title1"},[t._v("”开始编辑反馈信息!")])],1)])]),t.isFeedBack&&!t.fbDisabled?i("el-row",{staticClass:"content"},[i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[t._v("问题已存在反馈信息，点击”")]),i("el-link",{attrs:{type:"primary"},on:{click:t.openFbEidt}},[t._v("编辑反馈")]),i("div",{staticClass:"content-title1"},[t._v("”开始编辑反馈信息!")])],1)])]):t._e(),t.problemComment.length>0?i("el-row",{staticClass:"content"},[i("div",{staticClass:"content-row small",staticStyle:{margin:"10px 0 20px 0"}},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[t._v("评论:")])])]),i("div",{staticClass:"block"},[i("el-timeline",t._l(t.problemComment,(function(e){return i("el-timeline-item",{key:e.uuid,attrs:{timestamp:e.author_real_name+"（"+e.author_name+"）于"+e.create_datetime+"发布了一条类型为‘"+e.status+"’的评论,内容如下",placement:"top"}},[i("el-card",[e.author_uuid==t.admin.uuid?i("i",{staticClass:"el-icon-close",staticStyle:{display:"inline-block",float:"right","margin-top":"5px"},on:{click:function(i){return t.delComment(e.uuid)}}}):t._e(),i("p",{staticStyle:{"word-wrap":"break-word"}},[t._v(t._s(e.content))])])],1)})),1)],1)]):t._e(),t.isFeedBack&&!t.fbDisabled?i("el-row",{staticClass:"content"},[i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[t._v("如果对反馈信息有异议请，点击”")]),i("el-link",{attrs:{type:"primary"},on:{click:t.openPLEidt}},[t._v("评论")]),i("div",{staticClass:"content-title1"},[t._v("”开始编辑评论信息!")])],1)])]):t._e(),!t.isFeedBack&&t.fbDisabled?i("el-row",{staticClass:"content"},[i("div",{staticClass:"content-row"},[i("div",{staticClass:"content-col"},[i("div",{staticClass:"content-title1"},[t._v("问题暂无反馈信息。")])])])]):t._e()],1),i("div",{staticClass:"prOper"},[t.prDisabled?t._e():i("i",{staticClass:"el-icon-edit-outline iconInfo",staticStyle:{"font-size":"40px"},on:{click:t.openPrEdit}})])]),i("el-dialog",{attrs:{title:"问题修改",visible:t.openPr,width:"800px","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(e){t.openPr=e}}},[i("el-form",{ref:"formPr",attrs:{"label-position":"top",model:t.formPr,rules:t.rulesPr}},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"被检查问题单位",prop:"to_uuid"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"",placeholder:"被选择检查问题单位",clearable:"",filterable:""},on:{change:t.deptSelChange},model:{value:t.formPr.to_uuid,callback:function(e){t.$set(t.formPr,"to_uuid",e)},expression:"formPr.to_uuid"}},t._l(t.deptList,(function(t){return i("el-option",{key:t.uuid,attrs:{label:t.name,value:t.uuid}})})),1)],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"问题类型",prop:"problem_type"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择问题类型",disabled:"",clearable:"",filterable:""},on:{change:t.typeSelChange},model:{value:t.formPr.problem_type,callback:function(e){t.$set(t.formPr,"problem_type",e)},expression:"formPr.problem_type"}},t._l(t.problemType1,(function(t){return i("el-option",{key:t.uuid,attrs:{label:t.name,value:t.uuid}})})),1)],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"问题子类",prop:"type_uuid"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择问题分类",clearable:"",filterable:""},model:{value:t.formPr.type_uuid,callback:function(e){t.$set(t.formPr,"type_uuid",e)},expression:"formPr.type_uuid"}},t._l(t.problemList,(function(t){return i("el-option",{key:t.uuid,attrs:{label:t.name,value:t.uuid}})})),1)],1)],1)],1),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"问题描述",prop:"content"}},[i("el-input",{attrs:{type:"textarea",rows:"5",placeholder:"请输入内容",maxlength:"5000","show-word-limit":""},model:{value:t.formPr.content,callback:function(e){t.$set(t.formPr,"content",e)},expression:"formPr.content"}})],1)],1)],1),0!=t.formPr.storage_file.length?i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"问题原附件"}},[i("ul",{staticClass:"el-upload-list el-upload-list--picture-card"},t._l(t.formPr.storage_file,(function(e,o){return i("li",{key:o,staticClass:"el-upload-list__item is-success",staticStyle:{width:"100px",height:"100px"}},[i("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:"jpeg"==e.suffix||"png"==e.suffix||"jpg"==e.suffix?e.url2:t.fileImg}}),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-preview"},[i("i",{staticClass:"el-icon-delete",on:{click:function(i){return t.delFile(e,"pr")}}})])])])})),0)])],1)],1):t._e(),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"问题新附件"}},[i("ZMUpload",{attrs:{uploadList:t.beforeUpdateImg2},on:{"update:uploadList":function(e){t.beforeUpdateImg2=e},"update:upload-list":function(e){t.beforeUpdateImg2=e}}})],1)],1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.submitPr}},[t._v("确 定")]),i("el-button",{on:{click:t.colsePr}},[t._v("取 消")])],1)],1),i("el-dialog",{attrs:{title:t.title,visible:t.openFb,width:"800px","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(e){t.openFb=e}}},[i("el-form",{ref:"formFb",attrs:{model:t.formFb,rules:t.rulesFb,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"问题负责人"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",multiple:"",placeholder:"请输入姓名或警号","remote-method":t.remotePerson1,clearable:""},on:{change:function(e){return t.$forceUpdate()}},model:{value:t.to_uuid_person,callback:function(e){t.to_uuid_person=e},expression:"to_uuid_person"}},t._l(t.personList1,(function(t){return i("el-option",{key:t.uuid,attrs:{label:t.name+"-"+t.real_name,value:t.uuid}})})),1)],1),i("el-form-item",{attrs:{label:"属实情况"}},[i("el-radio",{attrs:{label:"FACT"},model:{value:t.formFb.is_fact,callback:function(e){t.$set(t.formFb,"is_fact",e)},expression:"formFb.is_fact"}},[i("el-tag",{attrs:{type:"success",effect:"dark"}},[t._v("属实")])],1),i("el-radio",{attrs:{label:"NOT_FACT"},model:{value:t.formFb.is_fact,callback:function(e){t.$set(t.formFb,"is_fact",e)},expression:"formFb.is_fact"}},[i("el-tag",{attrs:{type:"warning",effect:"dark"}},[t._v("不属实")])],1)],1),i("el-form-item",{attrs:{label:"反馈描述",prop:"content"}},[i("el-input",{attrs:{type:"textarea",rows:"5",placeholder:"请输入内容",maxlength:"5000","show-word-limit":""},model:{value:t.formFb.content,callback:function(e){t.$set(t.formFb,"content",e)},expression:"formFb.content"}})],1),t.isFeedBack?i("el-form-item",{attrs:{label:"反馈原附件"}},[i("ul",{staticClass:"el-upload-list el-upload-list--picture-card"},t._l(t.formFb.storage_file,(function(e,o){return i("li",{key:o,staticClass:"el-upload-list__item is-success",staticStyle:{width:"100px",height:"100px"}},[i("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:"jpeg"==e.suffix||"png"==e.suffix||"jpg"==e.suffix?e.url2:t.fileImg}}),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-preview"},[i("i",{staticClass:"el-icon-delete",on:{click:function(i){return t.delFile(e,"fb")}}})])])])})),0)]):t._e(),i("el-form-item",{attrs:{label:t.isFeedBack?"反馈新附件":"反馈附件"}},[i("ZMUpload",{attrs:{uploadList:t.beforeUpdateImg},on:{"update:uploadList":function(e){t.beforeUpdateImg=e},"update:upload-list":function(e){t.beforeUpdateImg=e}}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.submitFb}},[t._v("确 定")]),i("el-button",{on:{click:t.colsePr}},[t._v("取 消")])],1)],1),i("el-dialog",{attrs:{title:"评论",visible:t.openPL,width:"800px","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(e){t.openPL=e}}},[i("el-form",{ref:"formPL",attrs:{model:t.formPL,rules:t.rulesPL,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"评论状态"}},[i("el-radio",{attrs:{label:"已解决"},model:{value:t.formPL.status,callback:function(e){t.$set(t.formPL,"status",e)},expression:"formPL.status"}},[i("el-tag",{attrs:{type:"success",effect:"dark"}},[t._v("已解决")])],1),i("el-radio",{attrs:{label:"未解决"},model:{value:t.formPL.status,callback:function(e){t.$set(t.formPL,"status",e)},expression:"formPL.status"}},[i("el-tag",{attrs:{type:"warning",effect:"dark"}},[t._v("未解决")])],1)],1),i("el-form-item",{attrs:{label:"内容"}},[i("el-input",{attrs:{type:"textarea",rows:"5",placeholder:"请输入内容",maxlength:"5000","show-word-limit":""},model:{value:t.formPL.content,callback:function(e){t.$set(t.formPL,"content",e)},expression:"formPL.content"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.submitPL}},[t._v("确 定")]),i("el-button",{on:{click:t.colsePr}},[t._v("取 消")])],1)],1),t.imgViewerVisible?i("el-image-viewer",{attrs:{"on-close":t.closeImgViewer,"url-list":t.imgList}}):t._e()],1)},s=[],r=i("c7eb"),a=i("1da1"),l=i("2909"),n=i("5530"),c=(i("d3b7"),i("3ca3"),i("ddb0"),i("4de4"),i("14d9"),i("159b"),i("caad"),i("2532"),i("b0c0"),i("a15b"),i("d81d"),i("99af"),i("2f62")),u=i("25aa"),d=i("9d9a"),m=(i("df7c"),{computed:Object(n["a"])({},Object(c["b"])(["admin"])),components:{"el-image-viewer":function(){return Promise.all([i.e("chunk-elementUI"),i.e("chunk-cf7ab578")]).then(i.bind(null,"08a9"))},ZMUpload:u["a"]},data:function(){return{fileImg:i("87d4"),deptList:[],problemType1:[],problemType2:[],problemList:[],problemComment:[],openPr:!1,openFb:!1,openPL:!1,title:"",rulesPr:{to_uuid:[{required:!0,message:"被检查问题单位不能为空",trigger:"change"}],problem_type:[{required:!0,message:"问题类型不能为空",trigger:"change"}],type_uuid:[{required:!0,message:"问题子类不能为空",trigger:"change"}],content:[{required:!0,message:"问题描述不能为空",trigger:"change"}]},rulesFb:{content:[{required:!0,message:"问题描述不能为空",trigger:"change"}],is_fact:[{required:!0,message:"属实情况不能为空",trigger:"change"}]},rulesPL:{title:[{required:!0,message:"标题不能为空",trigger:"change"}],status:[{required:!0,message:"评论状态不能为空",trigger:"change"}],content:[{required:!0,message:"内容不能为空",trigger:"change"}]},beforeUpdateImg:[],beforeUpdateImg2:[],modelPr:{},modelFb:{},formPr:{to_uuid:"",type_uuid:"",content:"",problem_type:"",storage_file:[]},formFb:{is_fact:"",storage_file:[],content:""},formPL:{status:"已解决",content:"",problem_uuid:"",author_uuid:"",author_name:"",author_real_name:""},problemNumber:"",operate:"",isFeedBack:!1,prDisabled:!1,fbDisabled:!1,imgViewerVisible:!1,imgList:[],uuid:"",to_uuid_person:[],userList1:[],personList1:[],manageUser:[]}},watch:{$route:{immediate:!0,handler:function(){this.$route.query.number&&(this.problemNumber=this.$route.query.number),this.$route.query.id&&(this.uuid=this.$route.query.id),this.$route.query.operate,this.getData()}}},created:function(){},methods:{quickTo:function(t){this.$el.querySelector("#div"+t).scrollIntoView({block:"start",behavior:"smooth"})},getData:function(){this.isFeedBack=!1,this.prDisabled=!1,this.fbDisabled=!1,this.beforeUpdateImg=[],this.beforeUpdateImg2=[],this.modelPr={},this.modelFb={},this.formPr={to_uuid:"",type_uuid:"",content:"",problem_type:"",storage_file:[]},this.formFb={is_fact:"",storage_file:[],content:""},this.getProblemInfo(),this.getDepartmentList(),this.checkRole()},getDepartmentList:function(){var t=this;Object(d["q"])({level:2}).then((function(e){t.deptList=e.array}))},getDeptProblemTypeList:function(){var t=this;Object(d["A"])().then((function(e){e.array.length>0&&(t.problemType1=e.array.filter((function(t){return 1==t.level})),t.problemType2=e.array.filter((function(t){return 2==t.level})))}))},getProblemInfo:function(){var t=this,e={offset:0,rows:1};this.problemNumber&&(e.number=this.problemNumber),this.uuid&&(e.uuid=this.uuid),Object(d["C"])(e).then((function(e){if(e.array.length>0){if(t.modelPr=e.array[0],t.getComment(e.array[0].uuid),"FILED"==t.modelPr.status&&(t.fbDisabled=!0,t.prDisabled=!0),"zd_admin"==t.admin.role_name&&(t.fbDisabled=!1,t.admin.uuid!=t.modelPr.from_uuid&&(t.prDisabled=!0)),"zd_leader"==t.admin.role_name&&t.admin.department_uuid2!=t.modelPr.to_department_uuid&&(t.fbDisabled=!0),t.modelPr.responsible_uuid&&t.modelPr.responsible_uuid.length>0){for(var i=[],o=0;o<t.modelPr.responsible_real_name.length;o++)i.push(t.modelPr.responsible_real_name[o]+"("+t.modelPr.responsible_account_name[o]+")");t.modelPr.resArry=i}else t.modelPr.resArry=[];t.modelPr.storage_file&&t.modelPr.storage_file.length>0?t.modelPr.storage_file.forEach((function(t){t.url2="http://17.62.1.11:9010/webapp/problem_file/"+t.url,t.suffix.includes("jpeg")||t.suffix.includes("png")||t.suffix.includes("jpg")||t.suffix.includes("gif")?t.isImg=!0:t.isImg=!1})):t.modelPr.storage_file=[],console.log(t.modelPr.storage_file),t.getDeptProblemTypeList(),t.getProblemFeedBack(),t.getManager()}else t.$modal.msgError("问题不存在")}))},getProblemFeedBack:function(){var t=this,e={problem_uuid:this.modelPr.uuid,offset:0,rows:1};Object(d["t"])(e).then((function(e){e.array.length>0&&(t.prDisabled=!0,t.modelFb=e.array[0],t.modelFb.storage_file&&t.modelFb.storage_file.length>0?t.modelFb.storage_file.forEach((function(t){t.url2="http://17.62.1.11:9010/webapp/problem_file/"+t.url,t.suffix.includes("jpeg")||t.suffix.includes("png")||t.suffix.includes("jpg")||t.suffix.includes("gif")?t.isImg=!0:t.isImg=!1})):t.modelFb.storage_file=[],t.isFeedBack=!0)}))},getComment:function(t){var e=this;console.log(t);var i={problem_uuid:t,offset:0,rows:100};Object(d["p"])(i).then((function(t){e.problemComment=t.array}))},getManager:function(){var t=this,e={offset:0,rows:1e3,manage_department_uuid_like:this.modelPr.to_department_uuid};Object(d["o"])(e).then((function(e){t.manageUser=e.array}))},checkRole:function(){"fu_jing"==this.admin.role_name&&(this.prDisabled=!0,this.fbDisabled=!0)},deptSelChange:function(t){this.formPr.type_uuid="",this.formPr.problem_type="",this.problemList=[]},typeSelChange:function(t){this.formPr.type_uuid="",this.problemList=[],this.problemList=this.problemType2.filter((function(e){return e.parent_uuid==t}))},openPrEdit:function(){var t=this;this.beforeUpdateImg2=[],this.formPr.photos=[],Object.assign(this.formPr,this.modelPr),this.formPr.content=this.htmlDecode(this.formPr.content),this.problemType1.forEach((function(e){console.log(e.name),console.log(t.modelPr.problem_department_type_parent_name),e.name==t.modelPr.problem_department_type_parent_name&&(t.formPr.problem_type=e.uuid)})),this.problemList=this.problemType2.filter((function(e){return e.parent_uuid==t.formPr.problem_type})),this.openPr=!0},submitPr:function(){var t=this,e=this;this.$refs["formPr"].validate((function(i){if(i){if(t.formPr.content=t.htmlEncode(t.formPr.content),e.beforeUpdateImg2.length>0){var o={file_content:e.beforeUpdateImg2.map((function(t){return t.content})).join("|"),file_suffix:e.beforeUpdateImg2.map((function(t){return t.suffix})).join("|"),associate_type:"PROBLEM",associate_uuid:e.formPr.uuid};Object(d["g"])(o).then((function(t){var i={uuid:e.formPr.uuid,to_uuid:e.formPr.to_uuid,type_uuid:e.formPr.type_uuid,content:e.formPr.content};Object(d["j"])(i).then((function(t){e.$modal.msgSuccess("处理成功"),e.getProblemInfo(),e.openPr=!1}))}))}else{var s={uuid:e.formPr.uuid,to_uuid:e.formPr.to_uuid,type_uuid:e.formPr.type_uuid,content:e.formPr.content};Object(d["j"])(s).then((function(t){e.$modal.msgSuccess("处理成功"),e.getProblemInfo(),e.openPr=!1})),console.log(t.modelPr)}if("UN_FEEDBACK"==t.modelPr.status){var r={uuid:t.modelPr.uuid,status:"FEEDBACK"};Object(d["j"])(r).then((function(i){t.getProblemInfo(),e.openPr=!1}))}}}))},colsePr:function(){this.getProblemInfo(),this.openPr=!1,this.openFb=!1,this.openPL=!1},submitPL:function(){var t=this;this.formPL.content=this.htmlEncode(this.formPL.content),this.formPL.problem_uuid=this.modelPr.uuid,this.formPL.author_uuid=this.admin.uuid,this.formPL.author_name=this.admin.name,this.formPL.author_real_name=this.admin.real_name,console.log(this.modelPr.uuid),this.$refs["formPL"].validate((function(e){e&&Object(d["b"])(t.formPL).then((function(e){if(t.$modal.msgSuccess("评论成功"),t.getProblemInfo(),t.openPL=!1,"未解决"==t.formPL.status){var i={uuid:t.modelPr.uuid,status:"UN_FEEDBACK"};Object(d["j"])(i).then((function(e){t.getProblemInfo()}))}else{var o={uuid:t.modelPr.uuid,status:"FEEDBACK"};Object(d["j"])(o).then((function(e){t.getProblemInfo()}))}}))}))},delComment:function(t){var e=this;this.$modal.confirm("是否确认删除该评论").then((function(){Object(d["K"])({uuid:t}).then((function(t){e.$modal.msgSuccess("删除成功"),e.getProblemInfo()}))}))},remotePerson1:function(t){var e=this,i=0;this.personList1=[],this.userList1.forEach((function(o){(-1!=o.real_name.indexOf(t)&&i<=20||-1!=o.name.indexOf(t)&&i<=20)&&(e.personList1.push(o),i++)}))},openFbEidt:function(){var t=this;if(this.to_uuid_person=[],this.beforeUpdateImg=[],this.formFb.photos=[],this.isFeedBack){this.formFb.content=this.htmlDecode(this.modelFb.content),this.formFb.storage_file=this.modelFb.storage_file,this.formFb.is_fact=this.modelPr.is_fact,this.title="修改反馈";var e="";"NOT_FACT"==this.modelPr.is_fact?e="不属实":"FACT"==this.modelPr.is_fact&&(e="属实");var i="无";this.modelPr.responsible_uuid&&this.modelPr.responsible_uuid.length>0&&(i=this.modelPr.responsible_real_name.join(";")),this.formFb.content="\n=====================================================================\nhistory:【该问题于"+this.modelFb.last_update_datetime+"被"+this.modelFb.from_admin_array[0].real_name+"("+this.modelFb.from_admin_array[0].name+")反馈为"+e+"，指定了问题责任人"+i+"，描述为`"+this.formFb.content+"`】。"}else this.title="问题反馈",this.formFb.is_fact="FACT";this.modelPr.responsible_uuid&&this.modelPr.responsible_uuid.length>0?this.to_uuid_person=Object(l["a"])(this.modelPr.responsible_uuid):this.to_uuid_person=[],this.formFb.problem_uuid=this.modelPr.uuid,this.formFb.from_uuid=this.admin.uuid;var o={rows:1e3,offset:0,all_from_department_uuid:this.modelPr.to_department_uuid};Object(d["o"])(o).then((function(e){t.userList1=e.array,t.personList1=Object(l["a"])(t.userList1),t.openFb=!0,console.log(t.formFb)}))},openPLEidt:function(){this.openPL=!0,this.formPL={title:"",status:"已解决",content:"",problem_uuid:"",author_uuid:"",author_name:"",author_real_name:""}},submitFb:function(){var t=this;this.beforeUpdateImg.length>0&&(this.formFb.file_content=this.beforeUpdateImg.map((function(t){return t.content})).join("|"),this.formFb.file_suffix=this.beforeUpdateImg.map((function(t){return t.suffix})).join("|")),this.$refs["formFb"].validate((function(e){if(e)if(t.formFb.content=t.htmlEncode(t.formFb.content),t.isFeedBack){var i=t;if(i.beforeUpdateImg.length>0){var o={file_content:i.beforeUpdateImg.map((function(t){return t.content})).join("|"),file_suffix:i.beforeUpdateImg.map((function(t){return t.suffix})).join("|"),associate_type:"FEEDBACK",associate_uuid:i.modelFb.uuid};Object(d["g"])(o).then((function(t){var e={uuid:i.modelFb.uuid,content:i.formFb.content};Object(d["H"])(e).then((function(t){i.sendMsg(),i.updatePr()}))}))}else{var s={uuid:i.modelFb.uuid,content:i.formFb.content};Object(d["H"])(s).then((function(t){i.sendMsg(),i.updatePr()}))}}else Object(d["c"])(t.formFb).then((function(e){t.sendMsg(),t.updatePr()}))}))},updatePr:function(){var t=this,e={uuid:this.formFb.problem_uuid,fact:this.formFb.is_fact,read:"READ",status:"FEEDBACK",responsible_uuids:0==this.to_uuid_person.length?"clear":this.to_uuid_person.join(";")};Object(d["j"])(e).then((function(e){t.$modal.msgSuccess("处理成功"),t.getProblemInfo(),t.openFb=!1}))},downLoad:function(t){window.open(t)},delFile:function(t,e){var i=this,o=this;this.$modal.confirm("是否确认删除该附件").then((function(){Object(d["L"])({uuid:t.uuid}).then((function(i){"pr"==e?o.formPr.storage_file=o.formPr.storage_file.filter((function(e){return e!=t})):o.formFb.storage_file=o.formFb.storage_file.filter((function(e){return e!=t})),o.$forceUpdate()}))})).then((function(){i.handleQuery(),i.$modal.msgSuccess("删除成功")})).catch((function(){}))},viewImg:function(t){this.imgViewerVisible=!0,this.imgList=[t]},closeImgViewer:function(){this.imgViewerVisible=!1},sendMsg:function(){var t=this;return Object(a["a"])(Object(r["a"])().mark((function e(){var i,o,s,a,l,n;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=[],t.manageUser.length>0&&(i=i.concat(t.manageUser.map((function(t){return t.uuid})))),o=0;case 3:if(!(o<i.length)){e.next=11;break}return s=t.modelPr.department_name+"，在“"+t.modelPr.create_datetime+"”被发现“"+t.modelPr.problem_department_type_name+"”的问题已做反馈，请查看反馈详情。",a={from_uuid:t.admin.uuid,to_uuid:i[o],title:"反馈产生通知",content:s,remark:t.modelPr.uuid},e.next=8,t.addMsg(a);case 8:o++,e.next=3;break;case 11:if(!(t.modelPr.responsible_uuid&&t.modelPr.responsible_uuid.length>0)){e.next=21;break}l=0;case 13:if(!(l<t.modelPr.responsible_uuid.length)){e.next=21;break}return s=""+t.modelPr.department_name+t.modelPr.responsible_real_name[l]+"（"+t.modelPr.responsible_account_name[l]+"），在“"+t.modelPr.create_datetime+"”被发现“"+t.modelPr.problem_department_type_name+"”的问题已做反馈，请查看反馈详情。",n={from_uuid:t.admin.uuid,to_uuid:t.modelPr.responsible_uuid[l],title:"反馈产生通知",content:s,remark:t.modelPr.uuid},e.next=18,t.addMsg(n);case 18:l++,e.next=13;break;case 21:case"end":return e.stop()}}),e)})))()},addMsg:function(t){return new Promise((function(e){Object(d["d"])(t).then((function(t){return e("nextt")}))}))}}}),f=m,p=(i("062b"),i("2877")),_=Object(p["a"])(f,o,s,!1,null,null,null);e["default"]=_.exports},"87d4":function(t,e,i){t.exports=i.p+"static/img/file.78a29ab7.png"}}]);